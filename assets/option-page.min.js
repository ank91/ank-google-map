!function(e,o,t){"use strict";function a(e){var o=c.val().split("?",1);c.val(o[0]+"?page=agm_settings#top#"+e)}function n(e){var o=v.styles.filter(function(o){return o.id==e});return o.length?o[0].style:[]}function l(e){return o.querySelector("#"+e)||o.getElementById(e)}function r(){var a=Math.max(o.documentElement.clientWidth,e.innerWidth||0);d=new google.maps.LatLng(parseFloat(v.map.lat),parseFloat(v.map.lng)),u={draggable:a>480||!i(),center:d,streetViewControl:!0,zoom:parseInt(v.map.zoom),mapTypeId:google.maps.MapTypeId.ROADMAP,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM},mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU,position:google.maps.ControlPosition.TOP_LEFT},styles:n(v.map.style),fullscreenControl:!0,fullscreenControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP}},p=new google.maps.Map(h,u);var r=t("#agm-lat"),s=t("#agm-lng"),g=t("#agm-zoom"),c=t("#agm-zoom-val"),m=new google.maps.Marker({draggable:!0,position:d,map:p,title:"Current Location",icon:v.marker.file||v.marker.color||""});google.maps.event.addListener(p,"rightclick",function(e){r.val(e.latLng.lat()),s.val(e.latLng.lng()),m.setTitle("Selected Location"),m.setPosition(e.latLng)}),google.maps.event.addListener(m,"dragend",function(e){r.val(e.latLng.lat()),s.val(e.latLng.lng())}),google.maps.event.addListener(p,"zoom_changed",function(){g.val(p.getZoom()),c.html(p.getZoom())}),google.maps.event.addListener(p,"center_changed",function(){var e=p.getCenter();r.val(e.lat()),s.val(e.lng())}),google.maps.event.addListener(p,"idle",function(){google.maps.event.trigger(p,"resize")});var f;google.maps.event.addDomListener(e,"resize",function(){f&&clearTimeout(f),f=e.setTimeout(function(){p.setCenter(d)},300)}),g.on("input.agm click.agm",function(){c.html(this.value),p.setZoom(parseInt(g.val()))});var y=l("agm-search"),C=new google.maps.places.Autocomplete(y);p.controls[google.maps.ControlPosition.TOP_LEFT].push(y),google.maps.event.addListener(C,"place_changed",function(){var e=C.getPlace();e.geometry&&(p.panTo(e.geometry.location),m.setPosition(e.geometry.location),p.setZoom(15),m.setTitle(e.formatted_address))})}function i(){return"ontouchstart"in e||navigator.maxTouchPoints}var s=e.location.hash.replace("#top#",""),g=t("h2#wpt-tabs"),c=t("form#agm-form").find('input:hidden[name="_wp_http_referer"]'),m=t("section.tab-content");""!==s&&0!=t("#"+s).length||(s=m.attr("id")),t("#"+s).addClass("active"),t("#"+s+"-tab").addClass("nav-tab-active"),a(s),g.find("a.nav-tab").on("click.agm",function(e){e.stopPropagation(),g.find("a.nav-tab").removeClass("nav-tab-active"),m.removeClass("active");var o=t(this).attr("id").replace("-tab","");t("#"+o).addClass("active"),t(this).addClass("nav-tab-active"),a(o)});var p,d,v=e._agmOpt,u={},h=l("agm-canvas");"object"==typeof google&&google.maps?google.maps.event.addDomListener(e,"load",r):h.innerHTML='<h4 class="map-not-loaded" style="text-align: center;color: #ba060b">Failed to load Google Map.<br>Refresh this page and try again.<br>Check your internet connection as well.</h4>',t("#wpt-loc-tab").one("click.agm",function(){try{google.maps.event.trigger(p,"resize"),p.setCenter(d)}catch(e){console.error("Google map not loaded yet")}}),t("#agm-map-style").on("change.agm",function(e){e.preventDefault();try{p.setOptions({styles:n(t(this).val())})}catch(e){console.error("Google map not loaded yet")}}),t("#agm-search").on("keydown",function(e){return 13==e.keyCode||13==e.which?(e.preventDefault(),e.stopPropagation(),!1):void 0});try{t("#agm-border-color").wpColorPicker()}catch(f){console.error("WP Color Picker not loaded")}}(window,document,jQuery);